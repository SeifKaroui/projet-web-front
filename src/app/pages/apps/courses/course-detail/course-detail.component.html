<mat-card class="course-header-card overflow-hidden">
  <mat-card-content [ngStyle]="{ 'background': headerGradient }" class="text-white p-16">
    <div class="header-content" style="margin-left: 16px;">
      <!-- Bouton Retour -->
      <button mat-icon-button class="back-button" (click)="goBack()">
        <i-tabler name="chevron-left" class="icon-18"></i-tabler>
      </button>

      <!-- Titre du cours -->
      <div class="course-title">
        <h1 class="mat-headline">{{ courseDetail?.title }}</h1>
        <p class="mat-caption">{{ courseDetail?.description }}</p>
      </div>

      <!-- Informations supplémentaires -->
      <div class="course-info">
        <div class="info-item">
          <mat-icon class="info-icon">calendar_today</mat-icon>
          <span>Date de début : {{ courseDetail?.startDate | date }}</span>
        </div>
        <div class="info-item">
          <mat-icon class="info-icon">school</mat-icon>
          <span>Enseignant : {{ courseDetail?.teacher?.firstName }} {{ courseDetail?.teacher?.lastName }}</span>
        </div>
      </div>
    </div>
  </mat-card-content>
</mat-card>

<!-- Barre de navigation avec onglets -->
<mat-tab-group>
  <!-- Onglet Flux -->
  <mat-tab label="Flux">
    <mat-card class="stream-card mt-3">
      <mat-card-content>
        <!-- Section Stream pour les annonces -->
        <div class="stream-section">
          <h3 class="stream-title">Stream</h3>

          <!-- Section d'ajout d'annonce (réduite par défaut) -->
          <div *ngIf="isTeacher" class="add-announcement-section">
            <div class="add-announcement-header" (click)="toggleAnnouncementForm()">
              <h3>Créer une nouvelle annonce</h3>
              <mat-icon>{{ isAnnouncementFormOpen ? 'expand_less' : 'expand_more' }}</mat-icon>
            </div>

            <!-- Formulaire (développé lorsqu'ouvert) -->
            <div class="announcement-form-container" [class.open]="isAnnouncementFormOpen">
              <form (ngSubmit)="onSubmit()" class="announcement-form">
                <mat-form-field appearance="outline" class="full-width">
                  <input matInput [(ngModel)]="newAnnouncement.title" name="title" placeholder="Titre" required />
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                  <textarea matInput [(ngModel)]="newAnnouncement.description" name="description" placeholder="Description" required></textarea>
                </mat-form-field>

                <button mat-flat-button type="submit" color="primary" [disabled]="isSubmitting">
                  {{ isSubmitting ? 'En cours...' : 'Poster l\'annonce' }}
                </button>
              </form>
            </div>
          </div>

          <!-- Liste des annonces avec espacement réduit -->
          <div class="announcement-list mt-2" *ngIf="announcements.length > 0">
            <div *ngFor="let announcement of announcements" class="announcement-item">
              <h4>{{ announcement.title }}</h4>
              <p>{{ announcement.description }}</p>
              <small class="announcement-date">Posté le {{ announcement.date | date: 'dd/MM/yyyy à HH:mm' }}</small>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </mat-tab>

  <!-- Onglet Travaux et devoirs -->
  <mat-tab label="Travaux et devoirs">
    <mat-card class="homework-card mt-3">
      <mat-card-content>
        <h3 class="homework-title">Devoirs</h3>

        <!-- Bouton "Plus" pour ajouter un devoir -->
        <div *ngIf="isTeacher" class="add-homework-section">
          <div class="add-homework-header" (click)="toggleHomeworkForm()">
            <h3>Ajouter un devoir</h3>
            <mat-icon>{{ isHomeworkFormOpen ? 'expand_less' : 'expand_more' }}</mat-icon>
          </div>

          <!-- Formulaire (développé lorsqu'ouvert) -->
          <div class="homework-form-container" [class.open]="isHomeworkFormOpen">
            <form (ngSubmit)="onHomeworkSubmit()" class="homework-form">
              <mat-form-field appearance="outline" class="full-width">
                <input matInput [(ngModel)]="newHomework.title" name="title" placeholder="Titre du devoir" required />
              </mat-form-field>

              <mat-form-field appearance="outline" class="full-width">
                <textarea matInput [(ngModel)]="newHomework.description" name="description" placeholder="Description du devoir" required></textarea>
              </mat-form-field>

              <!-- Conteneur pour les champs de date et d'heure -->
              <div class="date-time-container">
                <!-- Champ Jour -->
                <mat-form-field appearance="outline" class="small-field">
                  <input matInput [(ngModel)]="newHomework.day" name="day" type="number" placeholder="Jour (JJ)" min="1" max="31" required />
                </mat-form-field>

                <!-- Champ Mois -->
                <mat-form-field appearance="outline" class="small-field">
                  <input matInput [(ngModel)]="newHomework.month" name="month" type="number" placeholder="Mois (MM)" min="1" max="12" required />
                </mat-form-field>

                <!-- Champ Année -->
                <mat-form-field appearance="outline" class="small-field">
                  <input matInput [(ngModel)]="newHomework.year" name="year" type="number" placeholder="Année (AAAA)" min="2023" required />
                </mat-form-field>

                <!-- Champ Heure -->
                <mat-form-field appearance="outline" class="small-field">
                  <input matInput [(ngModel)]="newHomework.time" name="time" type="time" placeholder="Heure (HH:MM)" required />
                </mat-form-field>
              </div>

              <button mat-flat-button type="submit" color="primary" [disabled]="isHomeworkSubmitting">
                {{ isHomeworkSubmitting ? 'En cours...' : 'Créer le devoir' }}
              </button>
            </form>
          </div>
        </div>

        <!-- Liste des devoirs -->
        <div class="homework-list mt-2" *ngIf="homeworks.length > 0; else noHomeworks">
          <div *ngFor="let homework of homeworks" class="homework-item">
            <h4>{{ homework.title }}</h4>
            <p>{{ homework.description }}</p>
            <small class="homework-date">À rendre pour le {{ homework.deadline | customDate }}</small>
            <small class="homework-date">Créé le {{ homework.createdAt | date: 'dd/MM/yyyy à HH:mm' }}</small>
            <small class="homework-date" *ngIf="homework.updatedAt">Dernière mise à jour le {{ homework.updatedAt | date: 'dd/MM/yyyy à HH:mm' }}</small>
          </div>
        </div>
        <ng-template #noHomeworks>
          <p class="no-homeworks-message">Aucun devoir disponible pour le moment.</p>
        </ng-template>
      </mat-card-content>
    </mat-card>
  </mat-tab>

  <!-- Onglet Personnes -->
  <mat-tab label="Personnes">
    <mat-card class="people-card mt-3">
      <mat-card-content>
        <h3 class="people-title">Personnes</h3>
        <!-- Ajoutez ici le contenu pour la section Personnes -->
        <p>Liste des étudiants et enseignants du cours.</p>
      </mat-card-content>
    </mat-card>
  </mat-tab>
</mat-tab-group>